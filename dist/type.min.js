/*! type v1.0.0 */
!function(a){"use strict";function b(a){var b=a.length,c=f(a);return"window"===f(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function c(a){if(h(a))return a;var c=[];if(b(a))for(var d=0,f=a.length;f>d;d++)c.push(a[d]);else e(a,function(a){c.push(a)});return c}function d(a,b){if(Array.prototype.forEach)a.forEach(b);else for(var c=0,d=a.length;d>c&&b.call(void 0,a[c],c)!==!1;c++);}function e(a,b){for(var c in a)if(m(a,c)&&b.call(void 0,a[c],c)===!1)break}function f(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase()}function g(a){return"function"===f(a)}function h(a){return"array"===f(a)}function i(a){return"object"===f(a)}function j(a){return"string"===f(a)}function k(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function l(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)m(a,c)&&b.push(c);return b}function m(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function n(a,b){if(a.indexOf)return a.indexOf(b);var c=-1;return d(a,function(a,d){return a===b?(c=d,!1):void 0}),c}function o(a){if("object"!==f(a)||a.nodeType||"window"===f(a))return!1;try{if(a.constructor&&!m(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0}function p(a,b,e){if(a=c(a),Array.prototype.map)return a.map(b,e);var f=[];return d(a,function(a,c){f.push(b.call(e,a,c))}),f}function q(){return p(arguments,function(a,b){return 0===b?a.replace(/\/$/,""):a.replace(/(^\/|\/$)/g,"")}).join("/")}function r(a,b){return function(){return a.apply(b,arguments)}}function s(a,b){return b?a():void 0}function t(a,b,c){void 0===c.enumerable&&(c.enumerable=!0),void 0===c.configurable&&(c.configurable=!0),Object.defineProperty(a,b,c)}function u(a){for(;;)if(!a.call(void 0))break}function v(a,b){for(var c=a.split("."),d=0,e=c.length,f=b||window;e>d;d++)m(f,c[d])||(f[c[d]]={}),f=f[c[d]];return f}function w(a,b,c){function d(c,d){var e=Object.getOwnPropertyDescriptor(b,c),f=!1,h=!1;if((void 0===e||"value"in e)&&(g(b[c])&&(a[d]=r(b[c],b),h=!0),f=!0),!h){var i,j;(f||void 0!==e.get)&&(i=function(){return b[c]}),(f||void 0!==e.set)&&(j=function(a){b[c]=a}),t(a,d,{get:i,set:j})}}var e,f,i=0;if(c)if(h(c))for(f=c.length;f>i;i++)d(c[i],c[i]);else{var j=l(c);for(f=j.length;f>i;i++)d(j[i],c[j[i]])}else for(e in b)d(e,e);return a}function x(a){return this instanceof x?void(this.value=a):new x(a)}function y(a){return this instanceof y?void(this.value=a):new y(a)}var z=function(){function a(a,c){if(!b[a]){var d=function(a){this.message=a};d.prototype=new b.Error,d.prototype.name=a,b[a]=d}return c?new b[a](c):b[a]}var b={Error:Error,TypeError:TypeError};return function(){return a.apply(void 0,arguments)}}(),A=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),B="public",C="private",D="protected",E="ctor",F=function(){if(a.setImmediate)return a.setImmediate;var b=[],c="https://github.com/stephenbunch/type/zero-timeout-message",d=function(a){b.push(a),window.postMessage(c,"*")},e=function(a){a.source===window&&a.data===c&&b.length>0&&b.shift()()};return window.addEventListener?window.addEventListener("message",e):window.attachEvent("onmessage",e),d}(),G=function(a){a=a||{},g(a)&&(a=a());var b="default",c=function(){if("new"===b)return b="void",new d;if("void"!==b){b="new";var a=d();b="default";var c=a.ctor.apply(a,arguments);return g(c)||h(c)||i(c)?c:a}},d=function(){return c.apply(void 0,arguments)};return a.ctor||(a.ctor=function(){}),d.prototype=a,d},H=function(){function a(a,b,c){for(var d=[{src:c,tmpl:b,dest:a}];d.length;){var e=d.shift();if(e.array)for(var g=0,h=e.array.length;h>g;g++)switch(f(e.array[g])){case"object":var i=e.array[g];e.array[g]={},d.push({tmpl:i,dest:e.array[g]});break;case"array":e.array[g]=e.array[g].slice(0),d.push({array:e.array[g]})}else for(var j in e.tmpl)if(void 0!==e.src[j])e.dest[j]=e.src[j];else switch(f(e.tmpl[j])){case"object":e.dest[j]={},d.push({tmpl:e.tmpl[j],dest:e.dest[j]});break;case"array":e.dest[j]=e.tmpl[j].slice(0),d.push({array:e.dest[j]});break;default:e.dest[j]=e.tmpl[j]}}}return function(b){var c="default",d=function(d){if("new"===c)return c="void",new e;if("void"!==c){c="new";var f=e();return c="default",a(f,b,d||{}),f}},e=function(){return d.apply(void 0,arguments)};return e}}(),I=new G({ctor:function(){this.keys=[],this.values=[]},add:function(a,b){n(this.keys,a)>-1||(this.keys.push(a),this.values.push(b))},remove:function(a){var b=n(this.keys,a);b>-1&&(this.keys.splice(b,1),this.values.splice(b,1))},get:function(a){var b=n(this.keys,a);return b>-1?this.values[b]:null},set:function(a,b){var c=n(this.keys,a);c>-1&&(this.values[c]=b)},contains:function(a){return n(this.keys,a)>-1}}),J=new G(function(){function a(b,c){if(c===b||c===b.promise)return b.reject(new TypeError("2.3.1 A promise returned from onFulfilled cannot refer to itself.")),!0;if(c){var d,e=!1;try{m(c,"then")&&(d=c.then)}catch(f){return b.reject(f),!0}if(g(d)){try{d.call(c,function(c){e||(e=!0,a(b,c)||b.resolve(c))},function(a){e||(e=!0,b.reject(a))})}catch(f){e||b.reject(f)}return!0}}}function b(b,c,e){var f=function(f,h){var i,j=f===d?c:e;if(!g(j))return void(f===d?b.resolve(h):b.reject(h));try{i=j.call(void 0,h)}catch(k){return void b.reject(k)}a(b,i)||b.resolve(i)};return function(){var a=arguments;F(function(){f.apply(void 0,a)})}}var c="pending",d="fulfilled",e="rejected";return{ctor:function(a){function f(a,b){if(h===c){h=a,j=b;for(var d=0,e=i.length;e>d;d++)i[d](h,j);i=[]}}var g=this,h=c,i=[],j=null;this.then=function(a,d){var e=new J,f=b(e,a,d);return h===c?i.push(f):f(h,j),e.promise},this.resolve=function(a){return f(d,a),g},this.reject=function(a){return f(e,a),g},this.finally=function(a){return g.then(function(b){var c=a.apply(void 0,arguments);return c&&m(c,"then")?c:b},function(b){var c=a(b);if(c&&m(c,"then"))return c;throw b})},this.promise={then:this.then,"finally":this.finally},t(this,"value",{get:function(){return j}}),t(this.promise,"value",{get:function(){return j}}),a&&a.call(void 0,g.resolve,g.reject)},splat:function(a,b){return this.then(function(b){return a.apply(void 0,b)},b)}}});J.when=function(a){a=h(a)?a:c(arguments);var b=new J,e=0,f=[];return d(a,function(c,d){c.then(function(c){f[d]=c,++e===a.length&&b.resolve(f)},function(a){b.reject(a)})}),a.length||b.resolve([]),b.promise},J.chain=function(a){a=h(a)?a:c(arguments);var b=new J;b.resolve();var e=b.promise;return d(a,function(a){e=e.then(g(a)?a:function(){return a})}),e},J.from=function(a){return(new J).resolve(a).promise};var K=new H({access:null,method:null,callsuper:!1}),L=new G({ctor:function(){this.system=null,this.tunnel=null},init:function(a,b,c,d){var e=this,f=this.system.createScope(a);return f.pub=b,this._build(f),this._morph(f),this._expose(f),t(f.pub,"__scope__",{enumerable:!1,get:function(){var a=f,b=e.tunnel.value();if(null!==b)for(;null!==a;){if(b===a.template.ctor)return a;a=a.parent}}}),d&&f.self.ctor.apply(f.self,c),s(function(){function b(c){null!==c.template.parent&&b(c.parent);for(var d=0,e=c.template.members.values.length;e>d;d++)c.template.members.values[d]instanceof P&&c.self[a.members.keys[d]]()}b(f)}),a=null,b=null,c=null,d=null,f},_build:function(a){null!==a.template.parent&&(a.parent=this.system.createScope(a.template.parent),a.parent.derived=a,a.parent.pub=a.pub,this._build(a.parent)),t(a.self,"$pub",{get:function(){return a.pub}}),null!==a.template.parent&&this._proxy(a.parent,a);for(var b=0,c=a.template.members.values.length;c>b;b++)a.template.members.values[b].build(a);if(!a.self.ctor){var d=new P;d.name=E,d.access=C,d.method=function(){},d.build(a)}},_proxy:function(a,b){for(var c=0,d=a.template.members.values.length;d>c;c++){var e=a.template.members.values[c];e.access===C||b.template.members.get(e.name)||(e instanceof P?b.self[e.name]=a.self[e.name]:e instanceof N?this._proxyEvent(a,b.self,e):e instanceof Q&&this._proxyProperty(a,b.self,e,[B,D]))}},_proxyEvent:function(a,b,c){t(b,c.name,{get:function(){return a.self[c.name].$pub},set:function(b){a.self[c.name]=b}})},_proxyProperty:function(a,b,c,d){var e={};c.get&&d.indexOf(c.get.access)>-1&&(e.get=function(){return a.self[c.name]}),c.set&&d.indexOf(c.set.access)>-1&&(e.set=function(b){a.self[c.name]=b}),t(b,c.name,e)},_morph:function(a){for(var b=a;null!==b.template.parent;){for(var c=0,d=b.template.parent.members.values.length;d>c;c++){var e=b.template.parent.members.values[c];if(e.virtual){var f=b.template.members.get(e.name);null!==f&&f.virtual&&b!==a||this._reverseProxy(e,null===f?b.parent:b,b.parent)}}b=b.parent}},_reverseProxy:function(a,b,c){var d;for(a instanceof Q&&(d={},a.get&&a.get.access!==C&&(d.get=function(){return b.self[a.name]}),a.set&&a.set.access!==C&&(d.set=function(c){b.self[a.name]=c}));null!==c;)a instanceof P?c.self[a.name]=b.self[a.name]:a instanceof Q&&t(c.self,a.name,d),c=c.parent},_expose:function(a){null!==a.template.parent&&this._expose(a.parent);for(var b=0,c=a.template.members.values.length;c>b;b++){var d=a.template.members.values[b];d.access===B&&(d instanceof P?a.pub[d.name]=a.self[d.name]:d instanceof N?this._proxyEvent(a,a.pub,d):d instanceof Q&&this._proxyProperty(a,a.pub,d,[B]))}}}),M=new G(function(){function a(a){var b=a.substr(0,2),c=m[b]||m[a[0]]||B,d=n[b]||n[a[0]]||!1;return a=a.substr(o[b]||o[a[0]]||0),a===E&&(c=C,d=!1),new O({access:c,virtual:d,name:a})}function b(a,b){if(c(a,b.name))throw z("DefinitionError","Member '"+b.name+"' is already defined.");if(b.access!==C&&null!==a.parent){var d=a.parent.members.get(b.name);if(null!==d&&d.access!==b.access)throw z("DefinitionError","Cannot change access modifier of member '"+b.name+"' from "+d.access+" to "+b.access+".")}}function c(a,b,d){var e=a.members.get(b);return null===e||d&&e.access===C||d&&!(e instanceof N)&&e.virtual!==!1?null!==a.parent?c(a.parent,b,!0):!1:!0}function e(a){var b=[],c=a.toString().match(/^function\s*\(([^())]+)\)/);if(null!==c)for(var d=c[1].split(","),e=0,f=d.length;f>e;e++)b.push(k(d[e]));var g=new P;return g.method=a,g.params=b,g}function f(b,c,d){var e=new Q;e.access=c.access,e.name=c.name,e.virtual=c.virtual,i(d)?e.value=d.value:(e.value=d,d={}),void 0===e.value&&(e.value=null);for(var f=l(d),h=0,k=f.length;k>h;h++){var m=d[f[h]],n=a(f[h].toLowerCase());if("get"===n.name||"set"===n.name){if(n.virtual)throw z("DefinitionError","Property '"+c.name+"' cannot have virtual accessors.");if(null!==m&&!g(m))throw z("TypeError","The "+n.name+" accessor for property '"+c.name+"' must be a function or null (uses default implementation.)");e[n.name]=new K({access:n.access===B?c.access:n.access,method:m})}}return e.get||e.set||(e.get=new K({access:c.access}),e.set=new K({access:c.access})),null!==e.get&&null===e.get.method&&(e.get.method=function(){return this.$value()}),null!==e.set&&null===e.set.method&&(e.set.method=function(a){this.$value(a)}),j(b,e),e}function j(a,b){for(var c=["get","set"],d=0,e=0,f=c.length;f>e;e++){var g=c[e],h=b[g];if(null!==h){var i=null!==a.parent?a.parent.members.get(b.name):null;if(null!==i&&i.access!==C&&null===i[g])throw z("DefinitionError","Cannot change read/write definition of property '"+b.name+"'.");if(p[h.access]<p[b.access])throw z("DefinitionError","The "+g+" accessor of the property '"+b.name+"' cannot have a higher visibility than the property itself.");if(h.access!==b.access&&d++,null!==i&&h.access!==i.access)throw z("DefinitionError","Cannot change access modifier of '"+g+"' accessor for property '"+b.name+"' from "+i.access+" to "+h.access+".")}}if(2===d)throw z("DefinitionError","Cannot set access modifers for both accessors of the property '"+b.name+"'.")}var m={__:C,_:D},n={$:!0,_$:!0},o={__:2,_$:2,_:1,$:1},p={};return p[B]=1,p[D]=2,p[C]=3,{ctor:function(){this.system=null},theParent:function(a,b){if(a.members.keys.length>0)throw z("DefinitionError","Cannot change the parent type after members have been defined.");if(!g(b))throw z("TypeError","Parent type must be a function.");if(this.system.isTypeOurs(b)){for(var c=this.system.getTemplate(b),d=c;d;){if(d===a)throw z("DefinitionError","Cannot inherit from "+(c===a?"self":"derived type")+".");d=d.parent}a.parent=c,a.ctor.prototype=this.system.createEmpty(c)}else a.ctor.prototype=new b},theMembers:function(j,k){k=i(k)?k:{},d(l(k),function(d){var i=a(d),l=k[d];if(b(j,i),!s(function(){return c(j,i.name)})){if(i.name===E&&(h(l)&&(j.ctor.$inject=l,l=l.pop()),!g(l)))throw z("TypeError","Member '"+E+"' must be a function.");var m;if(l===M.Event){if(m=new N,i.virtual)throw z("DefinitionError","Events cannot be virtual.")}else m=g(l)?e(l):f(j,i,l),m.virtual=i.virtual;m.name=i.name,m.access=i.access,m.virtual=i.virtual,j.members.add(i.name,m)}})}}});M.Event=function(){var a=function(){};return new a}();var N=new G(function(){var a=function(){var a,b=function(a,b){return a=r(a,b),a.valueOf=c,a};b.operands=[],b.reset=function(){b.operands=[],Function.prototype.valueOf=a};var c=function(){return 2===b.operands.length&&b.operands.splice(0,1),b.operands.push(this),Function.prototype.valueOf!==c&&(a=Function.prototype.valueOf,Function.prototype.valueOf=c),3};return b}();return{ctor:function(){this.name=null,this.access=null},build:function(b){function c(a){f.push(a)}function d(a){var b=n(f,a);b>-1&&f.splice(b,1)}var e=this,f=[],g=new a(function(){for(var a=f.slice(),b=0,c=a.length;c>b;b++)a[b].apply(void 0,arguments)});g.$pub=new a(function(){throw z("InvalidOperationError","The event '"+e.name+"' cannot be raised except from within its own type.")}),t(b.self,this.name,{get:function(){return g},set:function(b){if(2===a.operands.length&&(a.operands[0]===g||a.operands[0]===g.$pub)){var e=a.operands[1];6===b?c(e):0===b&&d(e)}a.reset()}})}}}),O=new H({access:null,virtual:!1,name:null}),P=new G({ctor:function(){this.params=[],this.access=null,this.virtual=!1,this.name=null,this.method=null},build:function(a){var b=this;if(this.name===E)this._buildConstructor(a);else if(null!==a.parent&&a.parent.self[this.name]){var c=a.parent.self[this.name];a.self[this.name]=function(){var d=a.self.$super;a.self.$super=c;var e=b.method.apply(a.self,arguments);return void 0===d?delete a.self.$super:a.self.$super=d,e}}else a.self[this.name]=function(){return b.method.apply(a.self,arguments)};a.self[this.name]=a.self[this.name]},_buildConstructor:function(a){var b=this;a.self.ctor=function(){var c=a.self.$super,d=!1,e=!1;delete a.self.ctor,null!==a.template.parent&&a.template.parent.members.contains(E)&&(a.template.parent.members.get(E).params.length>0?(a.self.$super=function(){e=!0,a.parent.self.ctor.apply(void 0,arguments)},d=!0):a.parent.self.ctor());var f=a.self.$include;if(a.self.$include=function(c,d){var e,f,g=0;if(d)if(h(d))for(f=d.length;f>g;g++)b._transclude(a,c,d[g],d[g]);else{var i=l(d);for(f=i.length;f>g;g++)b._transclude(a,c,i[g],d[i[g]])}else for(e in c)b._transclude(a,c,e,e)},b.method.apply(a.self,arguments),d){if(!e)throw z("InvalidOperationError","Constructor must call the parent constructor explicitly because it contains parameters.");void 0===c?delete a.self.$super:a.self.$super=c}void 0===f?delete a.self.$include:a.self.$include=f}},_transclude:function(a,b,c,d){var e=!1;if(a.derived&&(e=this._transclude(a.derived,b,c,d)),null===a.template.members.get(d)){var f=Object.getOwnPropertyDescriptor(b,c),h=!1,i=!1;if((void 0===f||"value"in f)&&(g(b[c])&&(a.self[d]=r(b[c],b),e||(a.pub[d]=a.self[d]),i=!0),h=!0),!i){var j,k;(h||void 0!==f.get)&&(j=function(){return b[c]}),(h||void 0!==f.set)&&(k=function(a){b[c]=a}),t(a.self,d,{get:j,set:k}),e||t(a.pub,d,{get:j,set:k})}}else e=!0;return e}}),Q=new G({ctor:function(){this.name=null,this.access=null,this.value=null,this.virtual=!1,this.get=null,this.set=null},build:function(a){function b(b,d){return function(){var e={_super:a.self.$super,_value:a.self.$value};a.self.$super=d,a.self.$value=function(a){return arguments.length&&(c=a),c};var f=b.apply(a.self,arguments);return void 0===e._super?delete a.self.$super:a.self.$super=e._super,void 0===e._value?delete a.self.$value:a.self.$value=e._value,f}}var c=this.value,d=null!==a.parent?Object.getOwnPropertyDescriptor(a.parent.self,this.name):null;t(a.self,this.name,{get:this.get?b(this.get.method,d&&d.get?d.get:void 0):void 0,set:this.set?b(this.set.method,d&&d.set?d.set:void 0):void 0})}}),R=new H({parent:null,self:null,derived:null,template:null,pub:null}),S=new G({ctor:function(){this.tunnel=null,this.builder=null,this._checkTypeOurs=!1,this._typeCheckResult=!1,this._returnScope=!1,this._returnBase=!1,this._returnTemplate=!1},isTypeOurs:function(a){this._checkTypeOurs=!0,a();var b=this._typeCheckResult;return this._typeCheckResult=!1,this._checkTypeOurs=!1,b},createScope:function(a){this._returnScope=!0;var b=a.ctor();return this._returnScope=!1,b},createEmpty:function(a){this._returnBase=!0;var b=new a.ctor;return this._returnBase=!1,b},getTemplate:function(a){this._returnTemplate=!0;var b=a();return this._returnTemplate=!1,b},createType:function(){var a=this,b=null,c=new T,d=!0,e=function(){if(!a._returnBase){if(a._checkTypeOurs)return void(a._typeCheckResult=!0);if(a._returnScope){null===b&&(b=a._createSelf(c));var e=new R;return e.template=c,e.self=new b,e}if(a._returnTemplate)return c;if(d){var f;return d=!1,f=new c.ctor,a.builder.init(c,f,arguments,!0),d=!0,f}}};return c.ctor=e,c.members=new I,c},_createSelf:function(a){var b=this,c=function(){};return c.prototype=this.createEmpty(a),c.prototype.$pry=function(c){b.tunnel.open(a.ctor);var d=c&&c.__scope__?c.__scope__:null;return b.tunnel.close(),null!==d?d.self:c},c}}),T=new H({members:null,parent:null,ctor:null}),U=new G({ctor:function(){this._value=null},open:function(a){this._value=a},close:function(){this._value=null},value:function(){return this._value}}),V=function(){function a(a){var d=c.createType();return b(d,a),d.ctor}function b(a,d){a.ctor.extend=function(d){var e=c.createType();return f.theParent(e,a.ctor),b(e,d),e.ctor},g(d)?f.theMembers(a,d.call(void 0)):f.theMembers(a,d),s(a.ctor)}var c=new S,d=new L,e=new U,f=new M;d.system=c,d.tunnel=e,c.builder=d,c.tunnel=e,f.system=c;var h=function(){return a.apply(void 0,arguments)};return h.extend=function(a,d){var e=c.createType();return f.theParent(e,a),b(e,d),e.ctor},h}(),W=new H({create:function(){},inject:[],filter:[]}),X=new G({ctor:function(a){this._binding=a},asSingleton:function(){var a,b=this._binding.create,c=!1;return this._binding.create=function(){return c||(a=b.apply(void 0,arguments),c=!0),a},this},whenFor:function(a){if(!h(a)||!a.length)throw z("ArgumentError","Expected 'services' to be an array of string.");return this._binding.filter=a.slice(0),this}}),Y=new G({ctor:function(a,b){this._cookbook=a,this._handlers=[],this.missing=[],this.component=null;var c=b instanceof bb?b:this._cookbook.search(b);if(null!==c)this.component=this._prepare(c);else{var d=this;this._need(b,function(a){d.component=a})}},update:function(a){this.missing=[];for(var b=this._handlers.slice(0),c=0,d=b.length;d>c;c++)b[c](a)},_prepare:function(a){var b=this,c=new $(a),e=[c];return u(function(){var a=e.shift();return a.recipe.lazy||d(a.recipe.ingredients,function(c,d){var f=b._cookbook.search(c,a.recipe.name);if(f){var g=new $(f);g.parent=a,g.order=d,a.children[d]=g,e.push(g)}else b._need(c,function(b){b.parent=a,b.order=d,a.children[d]=b})}),e.length}),c},_onUpdate:function(a,b){var c=this,d=a instanceof y,e=d||a instanceof x;if(d||e)a=a.value;else if(!j(a))throw z("InvalidOperationError","Expected 'service' to be a Lazy, Factory, or string. Perhaps there are multiple instances of this library running concurrently?");var f=function(g){var h=g[a];if(h){var i=c._cookbook.search(h);i?(i.factory=e,i.lazy=d,b(c._prepare(i))):c._need(h,b),c._handlers.splice(n(c._handlers,f),1)}};this._handlers.push(f)},_need:function(a,b){this.missing.push(a.value||a),this._onUpdate(a,b)}}),Z=new G({ctor:function(a,b){this._cookbook=a,this._load=b},create:function(a){function b(){i._load(i._getNames(k.missing)).then(c,e,!1)}function c(a){if(!h(a))return void j.reject(z("TypeError","Loaded successfully. Expected result to be an array."));var c={},e=!1;if(d(k.missing,function(b,d){var e=a[d];c[b]=!e||!/(function|array)/.test(f(e))||h(e)&&!g(e[e.length-1])?function(){return e}:e}),!e){try{k.update(c)}catch(i){return void j.reject(i)}k.missing.length?b():j.resolve(k.component)}}function e(a){j.reject(a)}var i=this,j=new J,k=new Y(this._cookbook,a);return k.missing.length?b():j.resolve(k.component),j.promise},createFactory:function(a){if(a.recipe.lazy)return this._createLazy(a);for(var b=this,d=[],e=a,f=[e];f.length;){var g=f.shift();if(d.push(g),!g.recipe.lazy)for(var h=0,i=g.children.length;i>h;h++)f.push(g.children[h])}return d.reverse(),d.pop(),function(){for(var a=0,f=d.length;f>a;a++){var g=d[a];g.parent.prep[g.order]=g.recipe.factory?b.createFactory(g):g.recipe.create.apply(void 0,g.prep),g.prep=[]}var h=e.prep.concat(c(arguments));return e.prep=[],e.recipe.create.apply(void 0,h)}},_createLazy:function(a){var b=this,c=null;return function(){var d=arguments;return c?(new J).resolve(c.apply(void 0,d)).promise:b.create(a.recipe.name).then(function(a){return c=b.createFactory(a),c.apply(void 0,d)},function(a){throw a},!1)}},_getNames:function(a){return p(a,function(a){return a instanceof x?a=a.value:a instanceof y&&(a=a.value),a})}}),$=new G({ctor:function(a){this.parent=null,this.order=null,this.prep=[],this.recipe=a,this.children=[]}}),_=new G({ctor:function(a){this._container=a},search:function(a,b){var c;return g(a)?new bb({create:a,ingredients:(a.$inject||[]).slice(0)}):h(a)?(a=a.slice(0),new bb({create:a.pop(),ingredients:a})):j(a)&&(c=this._lookup(a,b))?new bb({create:c.create,ingredients:c.inject.slice(0),name:a}):a instanceof x&&(c=this._lookup(a.value,b))?new bb({create:c.create,ingredients:c.inject.slice(0),name:a.value,factory:!0}):a instanceof y?(c=this._lookup(a.value,b)||{},new bb({create:c.create||null,ingredients:c.inject?c.inject.slice(0):null,name:a.value,factory:!0,lazy:!0})):null},_lookup:function(a,b){for(var c=this._container[a]||[],d=c.length-1;d>=0;d--)if(b){if(!c[d].filter.length||n(c[d].filter,b)>-1)break}else if(!c[d].filter.length)break;return c[d]||null}}),ab=new V(function(){var b=new G({ctor:function(a,b){this._kernel=a,this._service=b},to:function(a){return new X(this._kernel.registerProvider(this._service,a))},toConstant:function(a){return new X(this._kernel.registerProvider(this._service,function(){return a}))}});return{ctor:function(){this.container={},this.delegatingHandlers=[],this.moduleLoader=null,this.requireContext=null,this.detectModuleSupport(),this.chef=new Z(new _(this.container),this.chef_onLoad)},pathPrefix:{get:null,set:function(a){if(null!==a&&!j(a))throw z("ArgumentError","Value must be a string or `null`.");this.$value(a)}},useRequire:function(a){return a([],function(){}),this.requireContext=a,this.$pub},bind:function(a){if(!a||!j(a))throw z("ArgumentError","Argument 'service' must have a value.");return new b(this,a)},unbind:function(a,b){b=b||[];var c=this.container[a]||[],d=b.length;if(d){for(var e,f,g=0,h=c.length;h>g;g++){if(c[g].filter)for(e=0;d>e;e++)for(f=n(c[g].filter,b[e]);f>-1;)c[g].filter.splice(f,1),f=n(c[g].filter,b[e]);c[g].filter.length||(c.splice(g,1),g--)}c.length||delete this.container[a]}else delete this.container[a];return this.$pub},get:function(a,b){var d=this;return b=c(arguments),b.shift(0),this.chef.create(a).then(function(a){var c=d.chef.createFactory(a);return a.recipe.factory?c:c.apply(void 0,b)},function(a){throw a})},register:function(a){return this.registerGraph("",a),this.$pub},delegate:function(a,b){return j(a)&&(a=new RegExp(a.replace(".","\\.").replace("*",".*"))),this.delegatingHandlers.push({pattern:a,handler:b}),this.$pub},require:function(a){return this.moduleLoader(a)},__detectModuleSupport:function(){var b=this;void 0!==a.requirejs?(this.requireContext=a.requirejs,this.moduleLoader=function(a){var c=new J;return b.requireContext([a],function(a){c.resolve(a)}),c.promise}):A||(this.moduleLoader=function(a){return(new J).resolve(require(a)).promise})},__registerProvider:function(a,b){var c=null;if(h(b)){if(b=b.slice(0),c=new W({create:b.pop(),inject:b}),!g(c.create))throw z("ArgumentError","Expected last array element to be a function.")}else if(c=new W({create:b,inject:(b.$inject||[]).slice(0)}),!g(c.create))throw z("ArgumentError","Expected provider to be a function.");return this.container[a]=this.container[a]||[],this.container[a].push(c),c},__registerGraph:function(a,b){var c=this,d=""===a?"":a+".";e(b,function(a,b){o(a)?c.registerGraph(d+b,a):c.registerProvider(d+b,a)})},__resolvePath:function(a){return this.pathPrefix?q(this.pathPrefix,a):a},__chef_onLoad:function(a){var b=this,c=[];return d(a,function(a){var e=!1;if(d(b.delegatingHandlers,function(b){if(b.pattern.test(a)){var d=b.handler(a);if(d)return c.push(d),e=!0,!1}}),!e){if(null===b.moduleLoader)return c.push((new J).reject(new z("InvalidOperationError","The service '"+a+"' has not been registered.")).promise),!1;c.push(b.moduleLoader(b.resolvePath(a.replace(/\./g,"/"))))}}),J.when(c)}}}),bb=new H({create:function(){},ingredients:[],name:null,factory:!1,lazy:!1}),cb={Class:V,Event:M.Event,extend:V.extend,error:z,of:f,Task:J,Kernel:ab,Factory:x,Lazy:y,ns:v,setImmediate:F,merge:w};"undefined"!=typeof module&&module.exports?module.exports=cb:"function"==typeof define&&define.amd?define(function(){return cb}):window.type=cb}("undefined"==typeof global?window:global);