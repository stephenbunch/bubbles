/*! typejs v0.1.0 */
!function(a){"use strict";function b(a){if(g(a))return a;var b=[];return d(a,function(a){b.push(a)}),b}function c(a,b){if(Array.prototype.forEach)a.forEach(b);else for(var c=0,d=a.length;d>c&&b.call(void 0,a[c],c)!==!1;c++);}function d(a,b){for(var c in a)if(l(a,c)&&b.call(void 0,a[c],c)===!1)break}function e(a){return null===a?"null":void 0===a?"undefined":Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase()}function f(a){return"function"===e(a)}function g(a){return"array"===e(a)}function h(a){return"object"===e(a)}function i(a){return"string"===e(a)}function j(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function k(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)l(a,c)&&b.push(c);return b}function l(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function m(a,b){if(a.indexOf)return a.indexOf(b);var d=-1;return c(a,function(a,c){return a===b?(d=c,!1):void 0}),d}function n(a){if("object"!==e(a)||a.nodeType||"window"===e(a))return!1;try{if(a.constructor&&!l(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0}function o(a,d,e){if(a=b(a),Array.prototype.map)return a.map(d,e);var f=[];c(a,function(a,b){f.push(d.call(e,a,b))})}function p(){return o(arguments,function(a,b){return 0===b?a.replace(/\/$/,""):a.replace(/(^\/|\/$)/g,"")}).join("/")}function q(a,b){return function(){return a.apply(b,arguments)}}function r(a,b){return b?a():void 0}function s(a,b,c){if(void 0===c.enumerable&&(c.enumerable=!0),x&&delete c.enumerable,void 0===c.configurable&&(c.configurable=!0),x&&l(a,b)&&delete a[b],!Object.defineProperty)throw w("InitializationError","JavaScript properties are not supported by this browser.");Object.defineProperty(a,b,c)}function t(a){for(;;)if(!a.call(void 0))break}function u(a){return this instanceof u?(this.value=a,void 0):new u(a)}function v(a){return this instanceof v?(this.value=a,void 0):new v(a)}var w=function(){function a(a,c){if(!b[a]){var d=function(a){this.message=a};d.prototype=new b.Error,d.prototype.name=a,b[a]=d}return c?new b[a](c):b[a]}var b={Error:Error,TypeError:TypeError};return function(){return a.apply(void 0,arguments)}}(),x=function(){try{return Object.defineProperty({},"x",{}),!1}catch(a){return!0}}(),y=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),z="public",A="private",B="protected",C="ctor",D=function(){if(a.setImmediate)return a.setImmediate;var b=[],c="zero-timeout-message",d=function(a){b.push(a),window.postMessage(c,"*")},e=function(a){a.source===window&&a.data===c&&(a.stopPropagation(),b.length>0&&b.shift()())};return window.addEventListener("message",e,!0),d}(),E=function(a){a=a||{},f(a)&&(a=a());var b="default",c=function(){if("new"===b)return b="void",new d;if("void"!==b){b="new";var a=d();b="default";var c=a.ctor.apply(a,arguments);return f(c)||g(c)||h(c)?c:a}},d=function(){return c.apply(void 0,arguments)};return a.ctor||(a.ctor=function(){}),d.prototype=a,d},F=function(){function a(a,b,c){for(var d=[{src:c,tmpl:b,dest:a}];d.length;){var f=d.shift();if(f.array)for(var g=0,h=f.array.length;h>g;g++)switch(e(f.array[g])){case"object":var i=f.array[g];f.array[g]={},d.push({tmpl:i,dest:f.array[g]});break;case"array":f.array[g]=f.array[g].slice(0),d.push({array:f.array[g]})}else for(var j in f.tmpl)if(void 0!==f.src[j])f.dest[j]=f.src[j];else switch(e(f.tmpl[j])){case"object":f.dest[j]={},d.push({tmpl:f.tmpl[j],dest:f.dest[j]});break;case"array":f.dest[j]=f.tmpl[j].slice(0),d.push({array:f.dest[j]});break;default:f.dest[j]=f.tmpl[j]}}}return function(b){var c="default",d=function(d){if("new"===c)return c="void",new e;if("void"!==c){c="new";var f=e();return c="default",a(f,b,d||{}),f}},e=function(){return d.apply(void 0,arguments)};return e}}(),G=new E({ctor:function(){this.keys=[],this.values=[]},add:function(a,b){m(this.keys,a)>-1||(this.keys.push(a),this.values.push(b))},remove:function(a){var b=m(this.keys,a);b>-1&&(this.keys.splice(b,1),this.values.splice(b,1))},get:function(a){var b=m(this.keys,a);return b>-1?this.values[b]:null},set:function(a,b){var c=m(this.keys,a);c>-1&&(this.values[c]=b)},contains:function(a){return m(this.keys,a)>-1}}),H=new E(function(){function a(b,c){if(c===b)return b.reject(new TypeError("2.3.1 A promise returned from onFulfilled cannot refer to itself.")),!0;if(c){var d,e=!1;try{l(c,"then")&&(d=c.then)}catch(g){return b.reject(g),!0}if(f(d)){try{d.call(c,function(c){e||(e=!0,a(b,c)||b.resolve(c))},function(a){e||(e=!0,b.reject(a))})}catch(g){e||b.reject(g)}return!0}}}function b(b,c,e){var g=function(g,h){var i,j=g===d?c:e;if(!f(j))return g===d?b.resolve(h):b.reject(h),void 0;try{i=j.call(void 0,h)}catch(k){return b.reject(k),void 0}a(b,i)||b.resolve(i)};return function(){var a=arguments;D(function(){g.apply(void 0,a)})}}var c="pending",d="fulfilled",e="rejected";return{ctor:function(a){function f(a,b){if(h===c){h=a,j=b;for(var d=0,e=i.length;e>d;d++)i[d](h,j);i=[]}}var g=this,h=c,i=[],j=null;this.then=function(a,d){var e=new H,f=b(e,a,d);return h===c?i.push(f):f(h,j),e},this.resolve=function(a){return f(d,a),this},this.reject=function(a){return f(e,a),this},this.promise={then:this.then},a&&D(function(){a.call(void 0,g.resolve,g.reject)})},splat:function(a,b){return this.then(function(b){return a.apply(void 0,b)},b)}}});H.when=function(a){a=g(a)?a:b(arguments);var d=new H,e=0,f=[];return c(a,function(b,c){b.then(function(b){f[c]=b,++e===a.length&&d.resolve(f)},function(a){d.reject(a)})}),a.length||d.resolve([]),d.promise};var I=new F({access:null,method:null,callsuper:!1}),J=new E({ctor:function(){this.system=null,this.tunnel=null},init:function(a,b,c,d){var e=this,f=this.system.createScope(a);return s(f.self,"_pub",{get:function(){return b}}),this._build(f),this._expose(f,b),s(b,"__scope__",{enumerable:!1,get:function(){return e.tunnel.value()===a.ctor?f.self:void 0}}),d&&f.self.ctor.apply(f.self,c),r(function(){function b(c){null!==c.template.parent&&b(c.parent);for(var d=0,e=c.template.members.values.length;e>d;d++)c.template.members.values[d]instanceof O&&c.self[a.members.keys[d]]()}b(f)}),f},_build:function(a){if(null!==a.template.parent){var b=a.template.parent.members.get(C);if(null!==b&&b.params.length>0){var c=a.template.members.get(C);if(null===c||c.callsuper===!1)throw w("InitializationError","Base constructor contains parameters and must be called explicitly.")}a.parent=this.system.createScope(a.template.parent),a.parent.self._pub=a.self._pub,this._build(a.parent)}null!==a.template.parent&&this._proxy(a.parent,a);for(var d=0,e=a.template.members.values.length;e>d;d++)a.template.members.values[d].build(a);if(!a.self.ctor){var f=new O;f.name=C,f.access=A,f.method=function(){},f.build(a)}},_proxy:function(a,b){c(a.template.members.values,function(c){if(c.access!==A&&!b.template.members.get(c.name))if(c instanceof O||c instanceof M)b.self[c.name]=a.self[c.name];else if(c instanceof P){var d={};c.get&&c.get.access!==A&&(d.get=function(){return a.self[c.name]}),c.set&&c.set.access!==A&&(d.set=function(b){a.self[c.name]=b}),s(b.self,c.name,d)}})},_expose:function(a,b){null!==a.template.parent&&this._expose(a.parent,b),c(a.template.members.values,function(c){if(c.access===z)if(c instanceof O)b[c.name]=a.self[c.name];else if(c instanceof M)s(b,c.name,{get:function(){return a.self[c.name]._pub},set:function(b){a.self[c.name]=b}});else if(c instanceof P){var d={};c.get&&c.get.access===z&&(d.get=function(){return a.self[c.name]}),c.set&&c.set.access===z&&(d.set=function(b){a.self[c.name]=b}),s(b,c.name,d)}})}}),K=new E(function(){function a(a){var b=a.substr(0,2),c=m[b]||m[a[0]]||z,d=n[b]||n[a[0]]||!1;return a=a.substr(o[b]||o[a[0]]||0),a===C&&(c=A,d=!1),new N({access:c,virtual:d,name:a})}function b(a,b){if(d(a,b.name))throw w("DefinitionError","Member '"+b.name+"' is already defined.");if(b.access!==A&&null!==a.parent){var c=a.parent.members.get(b.name);if(null!==c&&c.access!==b.access)throw w("DefinitionError","Cannot change access modifier of member '"+b.name+"' from "+c.access+" to "+b.access+".")}}function d(a,b,c){var e=a.members.get(b);return null===e||c&&e.access===A||c&&!(e instanceof M)&&e.virtual!==!1?null!==a.parent?d(a.parent,b,!0):!1:!0}function e(a){var b=[],c=a.toString().match(/^function\s*\(([^())]+)\)/);if(null!==c)for(var d=c[1].split(","),e=0,f=d.length;f>e;e++)b.push(j(d[e]));var g=new O;return g.method=a,g.params=b,g.callsuper=q.test(a),g}function i(b,c,d){var e=new P;e.access=c.access,e.name=c.name,e.virtual=c.virtual,h(d)?e.value=d.value:(e.value=d,d={}),void 0===e.value&&(e.value=null);for(var g=k(d),i=0,j=g.length;j>i;i++){var m=d[g[i]],n=a(g[i].toLowerCase());if("get"===n.name||"set"===n.name){if(n.virtual)throw w("DefinitionError","Property '"+c.name+"' cannot have virtual accessors.");if(null!==m&&!f(m))throw w("TypeError","The "+n.name+" accessor for property '"+c.name+"' must be a function or null (uses default implementation.)");e[n.name]=new I({access:n.access===z?c.access:n.access,method:m})}}return e.get||e.set||(e.get=new I({access:c.access}),e.set=new I({access:c.access})),null!==e.get&&(null===e.get.method&&(e.get.method=function(){return this._value()}),e.get.callsuper=q.test(e.get.method)),null!==e.set&&(null===e.set.method&&(e.set.method=function(a){this._value(a)}),e.set.callsuper=q.test(e.set.method)),l(b,e),e}function l(a,b){for(var c=["get","set"],d=0,e=0,f=c.length;f>e;e++){var g=c[e],h=b[g];if(null!==h){var i=null!==a.parent?a.parent.members.get(b.name):null;if(null!==i&&i.access!==A&&null===i[g])throw w("DefinitionError","Cannot change read/write definition of property '"+b.name+"'.");if(p[h.access]<p[b.access])throw w("DefinitionError","The "+g+" accessor of the property '"+b.name+"' cannot have a higher visibility than the property itself.");if(h.access!==b.access&&d++,null!==i&&h.access!==i.access)throw w("DefinitionError","Cannot change access modifier of '"+g+"' accessor for property '"+b.name+"' from "+i.access+" to "+h.access+".")}}if(2===d)throw w("DefinitionError","Cannot set access modifers for both accessors of the property '"+b.name+"'.")}var m={__:A,_:B},n={$:!0,_$:!0},o={__:2,_$:2,_:1,$:1},p={};p[z]=1,p[B]=2,p[A]=3;var q=/xyz/.test(function(){xyz=0})?/\b_super\b/:/.*/;return{ctor:function(){this.system=null},theParent:function(a,b){if(a.members.keys.length>0)throw w("DefinitionError","Cannot change the parent type after members have been defined.");if(!f(b))throw w("TypeError","Parent type must be a function.");if(this.system.isTypeOurs(b)){for(var c=this.system.getTemplate(b),d=c;d;){if(d===a)throw w("DefinitionError","Cannot inherit from "+(c===a?"self":"derived type")+".");d=d.parent}a.parent=c,a.ctor.prototype=this.system.createEmpty(c)}else a.ctor.prototype=new b},theMembers:function(h,j){c(k(j||{}),function(c){var k=a(c),l=j[c];if(b(h,k),!r(function(){return d(h,k.name)})){if(k.name===C&&(g(l)&&(h.ctor.$inject=l,l=l.pop()),!f(l)))throw w("TypeError","Member '"+C+"' must be a function.");var m;if(l===K.Event){if(m=new M,k.virtual)throw w("DefinitionError","Events cannot be virtual.")}else m=f(l)?e(l):i(h,k,l),m.virtual=k.virtual;if(k.name===C&&!m.callsuper&&null!==h.parent){var n=h.parent.members.get(C);if(null!==n&&n.params.length>0)throw w("DefinitionError","Constructor must call the parent constructor explicitly because it contains parameters.")}m.name=k.name,m.access=k.access,m.virtual=k.virtual,h.members.add(k.name,m)}})}}});K.Event=function(){var a=function(){};return new a}();var L,M=new E(function(){var a=function(){var a,b=function(a,b){return a=q(a,b),a.valueOf=c,a};b.operands=[],b.reset=function(){b.operands=[],Function.prototype.valueOf=a};var c=function(){return 2===b.operands.length&&b.operands.splice(0,1),b.operands.push(this),Function.prototype.valueOf!==c&&(a=Function.prototype.valueOf,Function.prototype.valueOf=c),3};return b}();return{ctor:function(){this.name=null,this.access=null},build:function(b){function c(a){f.push(a)}function d(a){var b=m(f,a);b>-1&&f.splice(b,1)}var e=this,f=[],g=new a(function(){for(var a=0,b=f.length;b>a;a++)f[a].apply(void 0,arguments)});g._pub=new a(function(){throw w("InvalidOperationError","The event '"+e.name+"' cannot be raised except from within its own type.")}),s(b.self,this.name,{get:function(){return g},set:function(b){if(2===a.operands.length&&(a.operands[0]===g||a.operands[0]===g._pub)){var e=a.operands[1];6===b?c(e):0===b&&d(e)}a.reset()}})}}}),N=new F({access:null,virtual:!1,name:null}),O=new E({ctor:function(){this.callsuper=!1,this.params=[],this.access=null,this.virtual=!1,this.name=null,this.method=null},build:function(a){var b=this;if(this.name===C)this._buildConstructor(a);else if(null!==a.parent&&a.parent.self[this.name]){var c=a.parent.self[this.name];a.self[this.name]=function(){var d=a.self._super;a.self._super=c;var e=b.method.apply(a.self,arguments);return void 0===d?delete a.self._super:a.self._super=d,e}}else a.self[this.name]=function(){return b.method.apply(a.self,arguments)};a.self[this.name]=a.self[this.name]},_buildConstructor:function(a){var b=this;a.self.ctor=function(){var c=a.self._super;delete a.self.ctor,null!==a.template.parent&&a.template.parent.members.contains(C)&&(a.template.parent.members.get(C).params.length>0?a.self._super=a.parent.self.ctor:a.parent.self.ctor()),b.method.apply(a.self,arguments),void 0===c?delete a.self._super:a.self._super=c}}}),P=new E({ctor:function(){this.name=null,this.access=null,this.value=null,this.virtual=!1,this.get=null,this.set=null},build:function(a){function b(b,c){return function(){var e={_super:a.self._super,_value:a.self._value};a.self._super=c,a.self._value=function(a){return arguments.length&&(d=a),d};var f=b.apply(a.self,arguments);return void 0===e._super?delete a.self._super:a.self._super=e._super,void 0===e._value?delete a.self._value:a.self._value=e._value,f}}var c=this,d=this.value,e={};this.get&&(e.get=b(this.get.method,null===a.parent?null:function(){return a.parent.self[c.name]})),this.set&&(e.set=b(this.set.method,null===a.parent?null:function(b){a.parent.self[c.name]=b})),s(a.self,this.name,e)}}),Q=new F({parent:null,self:null,mixins:[],template:null}),R=new E(function(){function a(b,c){var d=b.prototype;d.constructor.prototype!==d&&a(d.constructor,c);for(var e in d)l(d,e)&&(c[e]=d[e])}function b(){var a,b=document.createElement();for(a in b)l(b,a)&&c(b,a);return b}function c(a,b){var c;Object.defineProperty(a,b,{configurable:!0,get:function(){return c},set:function(a){c=a}})}var d=function(a){return function(){return a.apply(void 0,arguments)}};return{ctor:function(){this.tunnel=null,this.builder=null,this._checkTypeOurs=!1,this._typeCheckResult=!1,this._returnScope=!1,this._returnBase=!1,this._returnTemplate=!1},isTypeOurs:function(a){this._checkTypeOurs=!0,a();var b=this._typeCheckResult;return this._typeCheckResult=!1,this._checkTypeOurs=!1,b},createScope:function(a){this._returnScope=!0;var b=a.ctor();return this._returnScope=!1,b},createEmpty:function(a){this._returnBase=!0;var b=new a.ctor;return this._returnBase=!1,b},getTemplate:function(a){this._returnTemplate=!0;var b=a();return this._returnTemplate=!1,b},createType:function(){var c=this,e=null,f=new S,g=!0,h=function(){if(!c._returnBase){if(c._checkTypeOurs)return c._typeCheckResult=!0,void 0;if(c._returnScope){null===e&&(e=c._createSelf(f));var d=new Q;return d.template=f,x?(d.self=b(),a(e,d.self)):d.self=new e,d}if(c._returnTemplate)return f;if(g){var h;return g=!1,x?(h=b(),a(f.ctor,h)):h=new f.ctor,c.builder.init(f,h,arguments,!0),g=!0,h}}};return f.ctor=d(h),f.members=new G,f},_createSelf:function(a){var b=this,c=function(){};return c.prototype=this.createEmpty(a),c.prototype._pry=function(c){b.tunnel.open(a.ctor);var d=c&&c.__scope__?c.__scope__:null;return b.tunnel.close(),d||c},c}}}),S=new F({members:null,parent:null,ctor:null}),T=new E({ctor:function(){this._value=null},open:function(a){this._value=a},close:function(){this._value=null},value:function(){return this._value}}),U=function(){var a=new R,b=new J,c=new T,d=new K;b.system=a,b.tunnel=c,a.builder=b,a.tunnel=c,d.system=a;var e=function(b){var c=a.createType();return g(c,b),c.ctor},g=function(b,c){b.ctor.extend=function(c){var e=a.createType();return d.theParent(e,b.ctor),g(e,c),e.ctor},f(c)?d.theMembers(b,c.call(void 0)):h(c)&&d.theMembers(b,c),L&&L(b.ctor),r(b.ctor)},i=function(){return e.apply(void 0,arguments)};return i.extend=function(b,c){var e=a.createType();return d.theParent(e,b),g(e,c),e.ctor},i}(),V=new F({create:function(){},inject:[],filter:[]}),W=new U({ctor:function(a){this.binding=a},asSingleton:function(){var a,b=this.binding.create,c=!1;return this.binding.create=function(){return c||(a=b.apply(void 0,arguments),c=!0),a},this._pub},whenFor:function(a){if(!g(a)||!a.length)throw w("ArgumentError","Expected 'services' to be an array of string.");return this.binding.filter=a.slice(0),this._pub}}),X=new E({ctor:function(a,b){this._cookbook=a,this._handlers=[],this.missing=[],this.component=null;var c=b instanceof ab?b:this._cookbook.search(b);if(null!==c)this.component=this._prepare(c);else{this.missing.push(b);var d=this;this._onUpdate(b,function(a){d.component=a})}},update:function(a){this.missing.splice(0);for(var b=this._handlers.slice(0),c=0,d=b.length;d>c;c++)b[c](a)},_prepare:function(a){var b=this,d=new Z(a),e=[d];return t(function(){var a=e.shift();return a.recipe.lazy||c(a.recipe.ingredients,function(c,d){var f=b._cookbook.search(c,a.recipe.name);if(f){var g=new Z(f);g.parent=a,g.order=d,a.children[d]=g,e.push(g)}else b.missing.push(c),b._onUpdate(c,function(b){b.parent=a,b.order=d,a.children[d]=b})}),e.length}),d},_onUpdate:function(a,b){var c=this,d=a instanceof v,e=d||a instanceof u;(d||e)&&(a=a.value);var f=function(g){var h=g[a];if(h){var i=c._cookbook.search(h);i?(i.factory=e,i.lazy=d,b(c._prepare(i))):(c.missing.push(h),c._onUpdate(h,b)),c._handlers.splice(m(c._handlers,f),1)}};this._handlers.push(f)}}),Y=new E({ctor:function(a,b){this._cookbook=a,this._loader=b},create:function(a){function b(){h=i._getRelativePaths(k.missing),i._loader()(h).then(c,d,!1)}function c(a){if(!g(a))return j.reject(w("TypeError","Loaded successfully. Expected result to be an array.")),!1;for(var c={},d=0,i=k.missing.length;i>d;d++){var l=k.missing[d].value||k.missing[d],m=a[d];if(!m||!/(function|array)/.test(e(m)))return j.reject(w("TypeError","Module '"+h[d]+"' loaded successfully. Failed to resolve service '"+l+"'. Expected service to be an array or function. Found '"+(m&&m.toString?m.toString():e(m))+"' instead.")),!1;if(g(m)&&!f(m[m.length-1]))return m=m[m.length-1],j.reject(w("InvalidOperationError","Module '"+h[d]+"' loaded successfully. Failed to resolve service '"+l+"'. Found array. Expected last element to be a function. Found '"+(m&&m.toString?m.toString():e(m))+"' instead.")),!1;c[l]=a[d]}"rejected"!==j.state&&(k.update(c),k.missing.length?b():j.resolve(k.component))}function d(a){j.reject(a)}var h,i=this,j=new H,k=new X(this._cookbook,a);return k.missing.length?this._loader()?b():j.reject(new w("InvalidOperationError","Service(s) "+o(k.missing,function(a){return"'"+a+"'"}).join(", ")+" have not been registered.")):j.resolve(k.component),j.promise},createFactory:function(a){if(a.recipe.lazy)return this._createLazy(a);for(var c=this,d=[],e=a,f=[e];f.length;){var g=f.shift();if(d.push(g),!g.recipe.lazy)for(var h=0,i=g.children.length;i>h;h++)f.push(g.children[h])}return d.reverse(),d.pop(),function(){for(var a=0,f=d.length;f>a;a++){var g=d[a];g.parent.prep[g.order]=g.recipe.factory?c.createFactory(g):g.recipe.create.apply(void 0,g.prep),g.prep=[]}var h=e.prep.concat(b(arguments));return e.prep=[],e.recipe.create.apply(void 0,h)}},_createLazy:function(a){var b=this,c=null;return function(){var d=arguments;return c?(new H).resolve(c.apply(void 0,d)).promise:b.create(a.recipe.name).then(function(a){return c=b.createFactory(a),c.apply(void 0,d)},function(a){throw a},!1)}},_getRelativePaths:function(a){return o(a,function(a){return a instanceof u?a=a.value:a instanceof v&&(a=a.value),a.replace(/\./g,"/")})}}),Z=new E({ctor:function(a){this.parent=null,this.order=null,this.prep=[],this.recipe=a,this.children=[]}}),$=new E({ctor:function(a){this._container=a},search:function(a,b){var c;return f(a)?new ab({create:a,ingredients:(a.$inject||[]).slice(0)}):g(a)?(a=a.slice(0),new ab({create:a.pop(),ingredients:a})):i(a)&&(c=this._lookup(a,b))?new ab({create:c.create,ingredients:c.inject.slice(0),name:a}):a instanceof u&&(c=this._lookup(a.value,b))?new ab({create:c.create,ingredients:c.inject.slice(0),name:a.value,factory:!0}):a instanceof v?(c=this._lookup(a.value,b)||{},new ab({create:c.create||null,ingredients:c.inject?c.inject.slice(0):null,name:a.value,factory:!0,lazy:!0})):null},_lookup:function(a,b){for(var c=this._container[a]||[],d=c.length-1;d>=0;d--)if(b){if(!c[d].filter.length||m(c[d].filter,b)>-1)break}else if(!c[d].filter.length)break;return c[d]||null}}),_=new U(function(){var c=new U({ctor:function(a,b){this.kernel=a,this.service=b},to:function(a){return new W(this.kernel.registerProvider(this.service,a))},toConstant:function(a){return new W(this.kernel.registerProvider(this.service,function(){return a}))}});return{ctor:function(){this.container={},this.detectModuleSupport();var a=this,b=new $(this.container);this.chef=new Y(b,function(){return null===a.require?null:function(b){return a.require(o(b,function(b){return a.resolvePath(b)}))}})},require:{get:null,set:function(a){if(null!==a&&!f(a))throw w("ArgumentError","Value must be a function or `null`.");this._value(a)}},pathPrefix:{get:null,set:function(a){if(null!==a&&!i(a))throw w("ArgumentError","Value must be a string or `null`.");this._value(a)}},bind:function(a){if(!a||!i(a))throw w("ArgumentError","Argument 'service' must have a value.");return new c(this,a)},unbind:function(a,b){b=b||[];var c=this.container[a]||[],d=b.length;if(d){for(var e,f,g=0,h=c.length;h>g;g++){if(c[g].filter)for(e=0;d>e;e++)for(f=m(c[g].filter,b[e]);f>-1;)c[g].filter.splice(f,1),f=m(c[g].filter,b[e]);c[g].filter.length||(c.splice(g,1),g--)}c.length||delete this.container[a]}else delete this.container[a];return this._pub},get:function(a,c){var d=this;return c=b(arguments),c.shift(0),this.chef.create(a).then(function(a){var b=d.chef.createFactory(a);return a.recipe.factory?b:b.apply(void 0,c)},function(a){throw a})},register:function(a){return this.registerGraph("",a),this._pub},__detectModuleSupport:function(){void 0!==a.requirejs?this.require=function(c){var d=new H;return a.requirejs(c,function(){d.resolve(b(arguments))}),d.promise}:y||(this.require=function(b){return(new H).resolve(o(b,function(b){return a.require(b)}))})},__registerProvider:function(a,b){var c=null;if(g(b)){if(b=b.slice(0),c=new V({create:b.pop(),inject:b}),!f(c.create))throw w("ArgumentError","Expected last array element to be a function.")}else if(c=new V({create:b,inject:(b.$inject||[]).slice(0)}),!f(c.create))throw w("ArgumentError","Expected provider to be a function.");return this.container[a]=this.container[a]||[],this.container[a].push(c),c},__registerGraph:function(a,b){var c=this,e=""===a?"":a+".";d(b,function(a,b){n(a)?c.registerGraph(e+b,a):c.registerProvider(e+b,a)})},__resolvePath:function(a){return this.pathPrefix?p(this.pathPrefix,a):a}}}),ab=new F({create:function(){},ingredients:[],name:null,factory:!1,lazy:!1}),bb={Class:U,Event:K.Event,extend:U.extend,error:w,of:e,Task:H,Kernel:_,Factory:u,Lazy:v,proxy:q};"undefined"!=typeof module&&module.exports?module.exports=bb:"function"==typeof define&&define.amd?define(function(){return bb}):window.type=bb}("undefined"==typeof global?window:global);